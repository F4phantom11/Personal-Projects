I added a do_combatS and do_combatR to the move file. This does range damamge for a bow and for a Area of effect spell. To enter range mode hit z. Then while in range mode move the cursor to the target.
If you have a range weapon press 'p' and it will attack with that. Hit z for the AOE spell. Spells always hit and range attacks as well with regualr attacks now roll to see if you hit. If you roll higher than the dodge you have you will avoid the attack. Defence reduces the damage by 10%. Weight will stop you from picking stuff up if your over the number. Mana regenerates every turn and spells have cooldowns.
